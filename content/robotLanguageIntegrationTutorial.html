<!DOCTYPE html><html>
        <head>
        <title>cmsite</title>
        <meta charset="utf-8">
<meta property="head" content="H2">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700,900" rel="stylesheet">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/icomoon/style.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/magnific-popup.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/jquery-ui.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.carousel.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.theme.default.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap-datepicker.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/flaticon/font/flaticon.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/aos.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/style.css">
        <link rel="shortcut icon" href="./../cmsimde/static/favicons.png">
        
        <style type='text/css'>
            .site-section {
            background-color: #FFFF;
            padding: 40px 40px;
            }
            body > div > div.dropdown.open {
                display: block;
            }
        </style>
    
        <!-- <script src="./../cmsimde/static/jquery.js"></script> -->
        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
        <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/normalize.min.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch_set.js"></script>
        <script src="tipuesearch_content.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/tipuesearch.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch.js"></script>
        <!-- for Wink3 客製化關閉 -->
        <!--
        <link rel="stylesheet" type="text/css" href="./../cmsimde/static/winkPlayer.css" />
        <script type="text/javascript" src="./../cmsimde/static/winkPlayer.js"></script>
        -->
        <script>
            /* original tipuesearch
            $(document).ready(function() {
                 $('#tipue_search_input').tipuesearch();
            });
            */
            // customed doSearch
            function doSearch() {
                $('#tipue_search_input').tipuesearch({
                    newWindow: true, 
                    minimumLength: 2,
                    wholeWords: false, // for search 中文
                });
            }
            $(document).ready(doSearch);
        </script>
        
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shCore.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushBash.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDiff.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJScript.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJava.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPython.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushSql.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushHaxe.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushXml.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPhp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPowerShell.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushLua.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCss.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCSharp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDart.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushRust.js"></script>
<link type="text/css" rel="stylesheet" href="./../cmsimde/static/syntaxhighlighter/css/shCoreDefault.css"/>
<script type="text/javascript">SyntaxHighlighter.all();</script>
<!-- 暫時不用
<script src="./../cmsimde/static/fengari-web.js"></script>
<script type="text/javascript" src="./../cmsimde/static/Cango-13v08-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/CangoAxes-4v01-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/gearUtils-05.js"></script>
-->
<!-- for Brython 暫時不用
<script src="https://scrum-3.github.io/web/brython/brython.js"></script>
<script src="https://scrum-3.github.io/web/brython/brython_stdlib.js"></script>
-->
<style>
img.add_border {
    border: 3px solid blue;
}
</style>

</head>
<body>
<div class='container-fluid'><nav>
        
    <div class="site-wrap">

    <div class="site-mobile-menu">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div>
    
            <header class="site-navbar py-4 bg-white" role="banner">
              <div class='container-fluid'>
                <div class="row align-items-center">
                <h1>cmsite</h1>
                <div class="pl-4">
                    <form>
                    <input type="text" placeholder="Search" name="q" id="tipue_search_input" pattern=".{2,}" title="At least 2 characters" required>
                    </form>
                </div>
                  <!-- <div class="col-11 col-xl-2">
                    <h1 class="mb-0 site-logo"><a href="index.html" class="text-black h2 mb-0">cmsite</a></h1> 
                  </div>
                  -->
                  <div class="col-12 col-md-10 d-none d-xl-block">
                    <nav class="site-navigation position-relative text-right" role="navigation">
    <ul class='site-menu js-clone-nav mr-auto d-none d-lg-block'>
                        <li class="active has-children"><a href="index.html">Home</a>
                        <ul class="dropdown">
                            <li><a href="sitemap.html">Site Map</a></li>
                            <li><a href="./../reveal/index.html">reveal</a></li>
                            <li><a href="./../blog/index.html">blog</a></li>
                        </ul>
                      </li>
                     <li><a href='welcome.html'>welcome</a><li class='has-children'><a href='userInterface.html'>userInterface</a><ul class='dropdown'><li><a href='pagesAndViews.html'>pagesAndViews</a><li><a href='coordinateDialog.html'>coordinateDialog</a><li><a href='positionDialog.html'>positionDialog</a><li><a href='orientationDialog.html'>orientationDialog</a><li><a href='objectMovement.html'>objectMovement</a><li><a href='positionOrientationTransformation.html'>positionOrientationTransformation</a><li><a href='settings.html'>settings</a><li><a href='shortcuts.html'>shortcuts</a></li></ul><li class='has-children'><a href='scenesAndModels.html'>scenesAndModels</a><ul class='dropdown'><li><a href='scenes.html'>scenes</a><li><a href='models.html'>models</a><li><a href='modelDialog.html'>modelDialog</a></li></ul><li class='has-children'><a href='environment.html'>environment</a><ul class='dropdown'><li><a href='environmentPropertiesDialog.html'>environmentPropertiesDialog</a><li><a href='textureDialog.html'>textureDialog</a></li></ul><li class='has-children'><a href='entities.html'>entities</a><ul class='dropdown'><li><a href='collections.html'>collections</a><li class='has-children'><a href='objects.html'>objects</a><ul class='dropdown'><li><a href='sceneObjectPropertiesDialog.html'>sceneObjectPropertiesDialog</a><li><a href='commonPropertiesDialog.html'>commonPropertiesDialog</a></li></ul><li><a href='collidableObjects.html'>collidableObjects</a><li><a href='measurableObjects.html'>measurableObjects</a><li><a href='detectableObjects.html'>detectableObjects</a><li><a href='viewableObjects.html'>viewableObjects</a><li><a href='convexHull.html'>convexHull</a><li class='has-children'><a href='layerSelectionDialog.html'>layerSelectionDialog</a><ul class='dropdown'><li><a href='cameras.html'>cameras</a><li><a href='cameraPropertiesDialog.html'>cameraPropertiesDialog</a><li><a href='lights.html'>lights</a><li><a href='lightPropertiesDialog.html'>lightPropertiesDialog</a><li><a href='shapes.html'>shapes</a><li><a href='shapeReferenceFrames.html'>shapeReferenceFrames</a><li><a href='primitiveShapes.html'>primitiveShapes</a><li><a href='convexDecomposition.html'>convexDecomposition</a><li><a href='shapeProperties.html'>shapeProperties</a><li><a href='shapeDynamicsProperties.html'>shapeDynamicsProperties</a><li><a href='shapeDynamicEngineProperties.html'>shapeDynamicEngineProperties</a><li><a href='geometryDialog.html'>geometryDialog</a><li><a href='shapeEditModes.html'>shapeEditModes</a><li><a href='triangleEditMode.html'>triangleEditMode</a><li><a href='vertexEditMode.html'>vertexEditMode</a><li><a href='edgeEditMode.html'>edgeEditMode</a><li><a href='groupedShapeEditMode.html'>groupedShapeEditMode</a><li><a href='joints.html'>joints</a><li><a href='jointModes.html'>jointModes</a><li><a href='jointProperties.html'>jointProperties</a><li><a href='jointDynamicsProperties.html'>jointDynamicsProperties</a><li><a href='jointDynamicEngineProperties.html'>jointDynamicEngineProperties</a><li><a href='dummies.html'>dummies</a><li><a href='dummyPropertiesDialog.html'>dummyPropertiesDialog</a><li><a href='graphs.html'>graphs</a><li><a href='graphPropertiesDialog.html'>graphPropertiesDialog</a><li><a href='proximitySensors.html'>proximitySensors</a><li><a href='proximitySensorDescription.html'>proximitySensorDescription</a><li><a href='proximitySensorPropertiesDialog.html'>proximitySensorPropertiesDialog</a><li><a href='proximitySensorVolumeDialog.html'>proximitySensorVolumeDialog</a><li><a href='proximitySensorDetectionParameterDialog.html'>proximitySensorDetectionParameterDialog</a><li><a href='visionSensors.html'>visionSensors</a><li><a href='visionSensorDescription.html'>visionSensorDescription</a><li><a href='visionSensorPropertiesDialog.html'>visionSensorPropertiesDialog</a><li><a href='forceSensors.html'>forceSensors</a><li><a href='forceSensorPropertiesDialog.html'>forceSensorPropertiesDialog</a><li><a href='octrees.html'>octrees</a><li><a href='octreePropertiesDialog.html'>octreePropertiesDialog</a><li><a href='pointClouds.html'>pointClouds</a><li><a href='pointCloudPropertiesDialog.html'>pointCloudPropertiesDialog</a></li></ul><li><a href='paths.html'>paths</a></li></ul><li class='has-children'><a href='functionality.html'>functionality</a><ul class='dropdown'><li><a href='geometricCalculations.html'>geometricCalculations</a><li><a href='collisionDetection.html'>collisionDetection</a><li class='has-children'><a href='distanceCalculation.html'>distanceCalculation</a><ul class='dropdown'><li><a href='geometricPlugin.html'>geometricPlugin</a><li><a href='simGeom API.html'>simGeom API</a><li><a href='coppeliaGeometricRoutines.html'>coppeliaGeometricRoutines</a><li><a href='CoppeliaGeometricRoutinesAPI.html'>CoppeliaGeometricRoutinesAPI</a></li></ul><li><a href='IGLPluginAPIreference.html'>IGLPluginAPIreference</a><li><a href='kinematics.html'>kinematics</a><li><a href='basicsOnIkGroupsAndIkElements.html'>basicsOnIkGroupsAndIkElements</a><li class='has-children'><a href='solvingIkAndFk.html'>solvingIkAndFk</a><ul class='dropdown'><li><a href='kinematicsPlugin.html'>kinematicsPlugin</a><li><a href='simIKAPI.html'>simIKAPI</a><li><a href='coppeliaKinematicsRoutines.html'>coppeliaKinematicsRoutines</a><li><a href='CoppeliaKinematicsRoutinesAPI.html'>CoppeliaKinematicsRoutinesAPI</a></li></ul><li><a href='dynamicsModule.html'>dynamicsModule</a><li class='has-children'><a href='designingDynamicSimulations.html'>designingDynamicSimulations</a><ul class='dropdown'><li><a href='dynamicsDialog.html'>dynamicsDialog</a><li><a href='dynamicsEngineDialog.html'>dynamicsEngineDialog</a></li></ul><li><a href='dataVisualizationAndOutput.html'>dataVisualizationAndOutput</a><li><a href='externalFrontEnd.html'>externalFrontEnd</a><li><a href='dataTransformation.html'>dataTransformation</a><li class='has-children'><a href='meansOfCommunication.html'>meansOfCommunication</a><ul class='dropdown'><li><a href='remoteApiOverview.html'>remoteApiOverview</a><li><a href='zmqRemoteApiOverview.html'>zmqRemoteApiOverview</a><li><a href='wsRemoteApiOverview.html'>wsRemoteApiOverview</a><li><a href='rosInterfaces.html'>rosInterfaces</a><li><a href='rosInterf.html'>rosInterf</a><li><a href='ROSPluginAPIreference.html'>ROSPluginAPIreference</a><li><a href='ros2Interface.html'>ros2Interface</a><li><a href='ROS2PluginAPIreference.html'>ROS2PluginAPIreference</a></li></ul><li><a href='ZMQPluginAPIreference.html'>ZMQPluginAPIreference</a><li><a href='WSPluginAPIreference.html'>WSPluginAPIreference</a><li><a href='pathsAndTrajectories.html'>pathsAndTrajectories</a><li><a href='pathAndMotionPlanningModules.html'>pathAndMotionPlanningModules</a><li><a href='OMPLPluginAPIreference.html'>OMPLPluginAPIreference</a><li><a href='syntheticVision.html'>syntheticVision</a><li><a href='IMPluginAPIreference.html'>IMPluginAPIreference</a><li><a href='simVisionAPI.html'>simVisionAPI</a><li><a href='customUIPlugin.html'>customUIPlugin</a><li><a href='UIPluginAPIreference.html'>UIPluginAPIreference</a><li><a href='simUI-widgets.html'>simUI-widgets</a><li><a href='QMLPluginAPIreference.html'>QMLPluginAPIreference</a><li><a href='importExport.html'>importExport</a><li class='has-children'><a href='xmlFormat.html'>xmlFormat</a><ul class='dropdown'><li><a href='urdfPlugin.html'>urdfPlugin</a><li><a href='APIFunctions.html'>APIFunctions</a><li><a href='sdfPlugin.html'>sdfPlugin</a><li><a href='SDFPluginAPIreference.html'>SDFPluginAPIreference</a></li></ul><li><a href='aviRecorder.html'>aviRecorder</a><li><a href='AssimpPluginAPIreference.html'>AssimpPluginAPIreference</a><li class='has-children'><a href='GLTFPluginAPIreference.html'>GLTFPluginAPIreference</a><ul class='dropdown'><li><a href='commandLine.html'>commandLine</a><li><a href='LuaCmdPluginAPIreference.html'>LuaCmdPluginAPIreference</a><li><a href='miscellaneousFunctionality.html'>miscellaneousFunctionality</a><li><a href='SurfRecPluginAPIreference.html'>SurfRecPluginAPIreference</a><li><a href='ICPPluginAPIreference.html'>ICPPluginAPIreference</a><li><a href='SubprocessPluginAPIreference.html'>SubprocessPluginAPIreference</a></li></li></ul></ul><li class='has-children'><a href='writingCode.html'>writingCode</a><ul class='dropdown'><li class='has-children'><a href='scripts.html'>scripts</a><ul class='dropdown'><li><a href='embeddedScripts.html'>embeddedScripts</a><li><a href='simulationScripts.html'>simulationScripts</a><li><a href='mainScript.html'>mainScript</a><li><a href='childScripts.html'>childScripts</a><li><a href='customizationScripts.html'>customizationScripts</a><li><a href='scriptProperties.html'>scriptProperties</a><li><a href='scriptEditor.html'>scriptEditor</a></li></ul><li><a href='addOns.html'>addOns</a><li><a href='sandboxScript.html'>sandboxScript</a><li><a href='scriptExecution.html'>scriptExecution</a><li class='has-children'><a href='threadedAndNonThreadedCode.html'>threadedAndNonThreadedCode</a><ul class='dropdown'><li><a href='callbackFunctions.html'>callbackFunctions</a><li><a href='dynCallbackFunctions.html'>dynCallbackFunctions</a><li><a href='jointCallbackFunctions.html'>jointCallbackFunctions</a><li><a href='contactCallbackFunction.html'>contactCallbackFunction</a><li><a href='visionCallbackFunctions.html'>visionCallbackFunctions</a><li><a href='triggerCallbackFunctions.html'>triggerCallbackFunctions</a><li><a href='userConfigCallbackFunctions.html'>userConfigCallbackFunctions</a></li></ul><li><a href='luaPythonDifferences.html'>luaPythonDifferences</a><li><a href='luaCrashCourse.html'>luaCrashCourse</a><li><a href='plugins.html'>plugins</a><li><a href='mainClientApplication.html'>mainClientApplication</a><li><a href='accessingSceneObjects.html'>accessingSceneObjects</a><li><a href='explicitHandling.html'>explicitHandling</a><li class='has-children'><a href='apisOverview.html'>apisOverview</a><ul class='dropdown'><li><a href='apiFunctions.html'>apiFunctions</a><li><a href='apiConstants.html'>apiConstants</a><li><a href='objectParameterIDs.html'>objectParameterIDs</a></li></li></ul></ul><li class='has-children'><a href='simulation.html'>simulation</a><ul class='dropdown'><li><a href='simulationPropertiesDialog.html'>simulationPropertiesDialog</a></li></ul><li class='has-children'><a href='tutorials.html'>tutorials</a><ul class='dropdown'><li><a href='bubbleRobTutorial.html'>bubbleRobTutorial</a><li><a href='buildingAModelTutorial.html'>buildingAModelTutorial</a><li><a href='lineFollowingBubbleRobTutorial.html'>lineFollowingBubbleRobTutorial</a><li><a href='inverseKinematicsTutorial.html'>inverseKinematicsTutorial</a><li><a href='externalControllerTutorial.html'>externalControllerTutorial</a><li><a href='pluginTutorial.html'>pluginTutorial</a><li><a href='robotLanguageIntegrationTutorial.html'>robotLanguageIntegrationTutorial</a><li class='has-children'><a href='rosTutorial.html'>rosTutorial</a><ul class='dropdown'><li><a href='ros1Tutorial.html'>ros1Tutorial</a><li><a href='ros2Tutorial.html'>ros2Tutorial</a></li></ul><li><a href='compilingCoppeliaSim.html'>compilingCoppeliaSim</a></li>
                      </ul>
                </nav>
              </div>
              <div class="d-inline-block d-xl-none ml-md-0 mr-auto py-3" style="position: relative; top: 3px;"><a href="#" class="site-menu-toggle js-menu-toggle text-black"><span class="icon-menu h3"></span></a></div>
              </div>

            </div>
          </div>
          
        </header>
    <div id="tipue_search_content">pluginTutorial << <a href='pluginTutorial.html'>Previous</a> <a href='rosTutorial.html'>Next</a> >> rosTutorial<br /><h1>robotLanguageIntegrationTutorial</h1><div align="center">
<table class="allEncompassingTable">
<tr>
<td>
<p><a href="../index.html" target="_top"><img src="./../images/homeImg.png"/></a></p>
<h4>Robot language interpreter integration tutorial</h4>
<p>This tutorial will try to explain how to integrate or embed a robot language interpreter into CoppeliaSim. The procedure is very similar in case you want to integrate an emulator (e.g. a specific microcontroller emulator) into CoppeliaSim. Extending CoppeliaSim's functionality requires most of the time the development of a <a href="plugins.html">plugin</a>. Make sure you have read the <a href="pluginTutorial.html">tutorial on plugins</a> , and the <a href="externalControllerTutorial.html">tutorial on external controllers</a> before proceeding with this tutorial.<br/>
</p>
<p>The CoppeliaSim <a href="scenes.html">scene</a> file related to this tutorial is located in CoppeliaSim's installation folder  <em>scenes\robotLanguageControl.ttt</em>. You can find the  plugin project files <a href="https://github.com/CoppeliaRobotics/simExtMTB" target="_blank">here</a>, and the server application project files <a href="https://github.com/CoppeliaRobotics/mtbServer" target="_blank">here</a>.</p>
<p>First, let's start by loading the related scene file <em>scenes\robotLanguageControl.ttt</em>:<br/>
</p>
<p align="center"><img src="./../images/robLangTut1.jpg"/></p>
<br/>
<p>The <em>MTB</em> robot is an imaginary robot (<em>MTB</em> stands for <em>Machine Type B</em>), that will be controlled with an imaginary robot language.</p>
<p>As previously stated, the used robot language is imaginary and very very simple. Following commands are supported (one command per line, input is case-sensitive):</p>
<pre class="lightGreyBox">
"REM" starts a comment line
"SETLINVEL v": sets the prismatic joint velocity for next movements (v is in m/s)
"SETROTVEL v": sets the revolute joint velocity for next movements (v is in degrees/s)
"MOVE p1 p2 p3 p4": moves to joint positions (p1;p2;p3;p4) (in degrees except for p3 in meters)
"WAIT x": waits x milliseconds
"SETBIT y": sets the bit at position y (1-32) in the robot output port
"CLEARBIT y": clears the bit at position y (1-32) in the robot output port
"IFBITGOTO y label": if bit at position y (1-32) in the robot input port is set, jump to "label"
"IFNBITGOTO y label": if bit at position y (1-32) in the robot input port is not set, jump to "label"
"GOTO label": jumps to "label"</pre>
<p>Any word different from "REM", "SETLINVEL", "SETROTVEL", "MOVE", "WAIT", "SETBIT", "CLEARBIT", "IFBITGOTO", "IFNBITGOTO" and "GOTO" is considered to be a label. Now run the simulation. If the related plugin was not found, following message displays (the display of the message is handled in the <a href="childScripts.html">child scripts</a> attached to <a href="objects.html">objects</a> <em>MTB_Robot</em> and <em>MTB_Robot#0</em>):<br/>
</p>
<p align="center"><img src="./../images/robLangTut3.jpg"/></p>
<br/>
<p>If the related plugin was found, then the the MTB plugin will launch a server application (i.e. <em>mtbServer</em>) that basically represents the robot language interpreter and controller. There is no direct need for a server application, the mtbServer functionality could also be directly running inside of the MTB plugin. The main advantages of using that functionality inside of a server application are:</p>
<li>The MTB plugin can act as intermediate for as many different languages as needed, also those that haven't been developed yet: the MTB plugin will simply launch the appropriate server depending on the used robot/language.</li>
<li>If the robot language interpreter / controller crashes, CoppeliaSim won't crash, since the two are distinct and separate processes.</li>
<p>Currently, the MTB server is in charge of two main tasks:</p>
<li>receive the program code (i.e. a buffer) from the MTB plugin, compile it, and initialize the robot controller.</li>
<li>apply input signals, step through the program code (the step duration can be different from step to step), and return output signals and joint angles. </li>
<p>If the MTB server detects an error during compilation of the program code, it will return an error message to the plugin, that will hand it over to the calling <a href="childScripts.html">child script</a> (i.e. in our case, the child scripts attached to objects <em>MTB_Robot</em> and <em>MTB_Robot#0</em>.), which will display (for example):<br/>
</p>
<p align="center"><img src="./../images/robLangTut4.jpg"/></p>
<br/>
<p>If the compilation was successful, then the robots start executing their respective program. The simulation is a <em>maximum speed</em> simulation, but can  be switched to real-time simulation by toggling the related toolbar button:</p>
<p align="center"><img src="./../images/realTimeButton.jpg"/></p>
<p> The execution speed can be even more accelerated by pressing the appropriate toolbar button several times:</p>
<p align="center"><img src="./../images/simulationAcceleration.jpg"/></p>
<p>Each  MTB robot  program can be individually paused, stopped or restarted at any time via their displayed custom dialog, which are <a href="customUIPlugin.html">custom user interfaces</a>:<br/>
</p>
<p align="center"><img src="./../images/robLangTut5.jpg"/></p>
<br/>
<p>Above custom UI is the user-interface of the MTB robot and can be fully customized. Should the MTB robot be copied, then its custom UI will also be copied. Next to being able to controlling the program execution state, the custom UI also displays current program line (<em>Command</em>) and the MTB's current joint values. The user can also change the robot's input port bits, and read the robot's output port bits. Input and output ports can be read and respectively written by the robot language program. Input and output ports can also be written and read by external devices (e.g. the robot's gripper or suction pad) by using appropriate function calls (see further below).<br/>
</p>
<p>There are two  child scripts attached to the <em>MTB_Robot</em> and <em>MTB_Robot#0</em> objects. They are in charge of handling the custom dialogs and communicating with the MTB plugin. Most code in the child scripts could be handled by the plugin too. Open the child script attached to one of the two MTB robot (e.g. with a double-click on the script icon next to the robot model in the scene hierarchy). At the top of the script, you will see the robot language code.<br/>
</p>
<p>Try to modify an MTB robot's program to have it perform a different movement sequence. Experiment a little bit.</p>
<p>The MTB robots are handled in following way:</p>
<li>
the actual robot language program is compiled and executed by the "mtbServer" application. That application also holds the MTB robot's state variables. For each MTB robot in the simulation scene, there will be an instance of the <em>mtbServer</em> application launched by the <em>simExtMTB</em> plugin.
</li>
<li>
the <em>simExtMTB</em> plugin is in charge of providing custom script functions, and  also  launches the <em>mtbServer</em> application when needed, and communicates with it via socket communication.</li>
<li>
the child scripts attached to <em>MTB_Robot</em> and <em>MTB_Robot#0</em> check whether the <em>simExtMTB</em> plugin is loaded and handle the communication with the plugin. </li>
<p>The MTB robot and its simple robot language is a simple prototype meant to demonstrate how to integrate a robot language interpreter into CoppeliaSim. It is very easy to extend current functionality for much more complex robots or robot languages. All what is needed is:<br/>
</p>
<li>Building the <a href="models.html">model</a> of the robot. This includes <a href="importExport.html">importing CAD data</a>, adding <a href="joints.html">joints</a>, etc. This step can be entirely done in CoppeliaSim.<br/>
</li>
<li>Writing a <a href="plugins.html">plugin</a> to handle the new robot natively, i.e. to handle the new robot by interpreting its own robot language. Any language capable of accessing C-API functions and capable of being wrapped in a dll can be used to create the plugin (but c/c++ is preferred). The robot language interpreter could be directly embedded in the plugin, or launched as an external application (<em>mtbServer</em>) as is done in this tutorial.<br/>
</li>
<li>Writing a small <a href="childScripts.html">child script</a> responsible for handling <a href="customUIPlugin.html">custom dialogs</a> and linking the robot with the plugin. This step can be entirely done in CoppeliaSim.<br/>
</li>
<p>Now let's have a look at the MTB's plugin project. There is one prerequisites to embedding a robot language interpreter (or other emulator) into CoppeliaSim:<br/>
</p>
<li>The robot language interpreter should be able to be executed several times in parallel. This means that several interpreter instances should be supported, in order to support several identical, in-parallel operating robots. This can be handled the easiest by launching a new interpreter for each new robot, as is done in this tutorial.<br/>
</li>
<p>When writing any plugin, make sure that the plugin accesses CoppeliaSim's <a href="apiFunctions.html">regular API</a> only from the main thread (or from a thread created by CoppeliaSim)! The plugin can launch new threads, but in that case those new threads should not be used to access CoppeliaSim (they can however be used to communicate with a server application, to communicate with some hardware, to execute background calculations, etc.).</p>
<br/>
<p>Now let's have a look at the child script that is attached to the MTB robot. The code might seem quite long or complicated. However most functionality handled in the child script could also be directly handled in the plugin, making the child script much smaller/cleaner. The advantage in handling most functionality in the child script is that modifications can be performed without having to recompile the plugin!<br/>
</p>
<p>Following is the MTB robot's child script main functionality:<br/>
</p>
<li>
Checking whether the plugin was loaded. If not, an error message is output.</li>
<li>Communicating with the plugin. This means that information is sent to and received from the MTB plugin with custom script functions.<br/>
</li>
<li>Applying the newly calculated joint values to the MTB robot model. This could also be handled in the MTB's plugin.<br/>
</li>
<li>Reacting to events on the custom dialogs, like button presses.</li>
<li>Updating the state of the custom dialogs.<br/>
</li>
<p>Following 3 custom script functions are of main interest (others are exported by the plugin): <br/>
</p>
<pre class="brush:lua;auto-links:false;toolbar:false" contenteditable="false">
int mtbServerHandle,string message=simMTB.startServer(string mtbServerExecutable,
    int portNumber,charBuffer program,table[4] jointPositions, table[2] velocities)</pre>
<pre class="brush:lua;auto-links:false;toolbar:false" contenteditable="false">
int result,string message=simMTB.step(int mtbServerHandle,float timeStep)</pre>
<pre class="brush:lua;auto-links:false;toolbar:false" contenteditable="false">
table[4] jointValues=simMTB.getJoints(int mtbServerHandle)</pre>
<li>simMTB.startServer: launches the server application (e.g. <em>mtbServer</em>) on the specified port, connects to it, and sends it the robot language code, the initial linear/angular joint positions, and the initial velocities. In return, the function returns a server handle (if successful), and a message (usually a compilation error message).</li>
<li>simMTB.step: steps through the robot language program with the specified timeStep, and returns a result value and a message (usually the code being currently executed).</li>
<li>simMTB.getJoints: retrieves the current linear/angular joint positions. The linear/angular joint positions are automatically updated when <em>simMTB.step</em> is called.</li>
<p>You could also imagine slightly modifying the step function, and add one additional function, in order to be able to handle intermediate events triggered by the robot language program execution. In that case, each simulation step would have to execute following script code (in a child script):<br/>
</p>
<pre class="brush:lua;auto-links:false;toolbar:false" contenteditable="false">
local dt=sim.getSimulationTimeStep()
while (dt&gt;0) do
    result,dt,cmdMessage=simMTB.step(mtbServerHandle,dt) -- where the returned dt is the remaining dt
    local event=simMTB.getEvent()
    while event~=-1 do
        -- handle events here
        event=simMTB.getEvent()
    end
end</pre>
<br/>
<br/>
</td></tr>
</table>
</div><br />pluginTutorial << <a href='pluginTutorial.html'>Previous</a> <a href='rosTutorial.html'>Next</a> >> rosTutorial</div>
        
    <!-- footer -->
      <div class='container-fluid'>
        <div class="row pt-3 mx-auto">
            <p>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank" >Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
        </div>
      </div>
    <!-- for footer -->
    
        </div> <!-- for site wrap -->
            <!-- <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script> -->
            <script src="../cmsimde/static/chimper/js/jquery-migrate-3.0.1.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery-ui.js"></script>
            <script src="../cmsimde/static/chimper/js/popper.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap.min.js"></script>
            <script src="../cmsimde/static/chimper/js/owl.carousel.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.stellar.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.countdown.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.magnific-popup.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap-datepicker.min.js"></script>
            <script src="../cmsimde/static/chimper/js/aos.js"></script>
            <!--
            <script src="../cmsimde/static/chimper/js/typed.js"></script>
                    <script>
                    var typed = new Typed('.typed-words', {
                    strings: ["Web Apps"," WordPress"," Mobile Apps"],
                    typeSpeed: 80,
                    backSpeed: 80,
                    backDelay: 4000,
                    startDelay: 1000,
                    loop: true,
                    showCursor: true
                    });
                    </script>
            -->
            <script src="../cmsimde/static/chimper/js/main.js"></script>
        
<!-- 啟用 LaTeX equations 編輯 -->
  <!-- <script>
  MathJax = {
    tex: {inlineMath: [['$', '$'], ['\(', '\)']]}
  };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>-->
    </body></html>
        