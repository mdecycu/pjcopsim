<!DOCTYPE html><html>
        <head>
        <title>cmsite</title>
        <meta charset="utf-8">
<meta property="head" content="H2">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link href="https://fonts.googleapis.com/css?family=Quicksand:300,400,500,700,900" rel="stylesheet">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/icomoon/style.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/magnific-popup.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/jquery-ui.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.carousel.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.theme.default.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap-datepicker.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/flaticon/font/flaticon.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/aos.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/style.css">
        <link rel="shortcut icon" href="./../cmsimde/static/favicons.png">
        
        <style type='text/css'>
            .site-section {
            background-color: #FFFF;
            padding: 40px 40px;
            }
            body > div > div.dropdown.open {
                display: block;
            }
        </style>
    
        <!-- <script src="./../cmsimde/static/jquery.js"></script> -->
        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
        <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/normalize.min.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch_set.js"></script>
        <script src="tipuesearch_content.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/tipuesearch.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch.js"></script>
        <!-- for Wink3 客製化關閉 -->
        <!--
        <link rel="stylesheet" type="text/css" href="./../cmsimde/static/winkPlayer.css" />
        <script type="text/javascript" src="./../cmsimde/static/winkPlayer.js"></script>
        -->
        <script>
            /* original tipuesearch
            $(document).ready(function() {
                 $('#tipue_search_input').tipuesearch();
            });
            */
            // customed doSearch
            function doSearch() {
                $('#tipue_search_input').tipuesearch({
                    newWindow: true, 
                    minimumLength: 2,
                    wholeWords: false, // for search 中文
                });
            }
            $(document).ready(doSearch);
        </script>
        
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shCore.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushBash.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDiff.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJScript.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJava.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPython.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushSql.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushHaxe.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushXml.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPhp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPowerShell.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushLua.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCss.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCSharp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDart.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushRust.js"></script>
<link type="text/css" rel="stylesheet" href="./../cmsimde/static/syntaxhighlighter/css/shCoreDefault.css"/>
<script type="text/javascript">SyntaxHighlighter.all();</script>
<!-- 暫時不用
<script src="./../cmsimde/static/fengari-web.js"></script>
<script type="text/javascript" src="./../cmsimde/static/Cango-13v08-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/CangoAxes-4v01-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/gearUtils-05.js"></script>
-->
<!-- for Brython 暫時不用
<script src="https://scrum-3.github.io/web/brython/brython.js"></script>
<script src="https://scrum-3.github.io/web/brython/brython_stdlib.js"></script>
-->
<style>
img.add_border {
    border: 3px solid blue;
}
</style>

</head>
<body>
<div class='container'><nav>
        
    <div class="site-wrap">

    <div class="site-mobile-menu">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div>
    
            <header class="site-navbar py-4 bg-white" role="banner">
              <div class="container">
                <div class="row align-items-center">
                <h1>cmsite</h1>
                <div class="pl-4">
                    <form>
                    <input type="text" placeholder="Search" name="q" id="tipue_search_input" pattern=".{2,}" title="At least 2 characters" required>
                    </form>
                </div>
                  <!-- <div class="col-11 col-xl-2">
                    <h1 class="mb-0 site-logo"><a href="index.html" class="text-black h2 mb-0">cmsite</a></h1> 
                  </div>
                  -->
                  <div class="col-12 col-md-10 d-none d-xl-block">
                    <nav class="site-navigation position-relative text-right" role="navigation">
    <ul class='site-menu js-clone-nav mr-auto d-none d-lg-block'>
                        <li class="active has-children"><a href="index.html">Home</a>
                        <ul class="dropdown">
                            <li><a href="sitemap.html">Site Map</a></li>
                            <li><a href="./../reveal/index.html">reveal</a></li>
                            <li><a href="./../blog/index.html">blog</a></li>
                        </ul>
                      </li>
                     <li><a href='User Manual.html'>User Manual</a><li class='has-children'><a href='User interface.html'>User interface</a><ul class='dropdown'><li><a href='Pages and views.html'>Pages and views</a><li><a href='Positionorientation manipulation.html'>Positionorientation manipulation</a><li><a href='Position dialog.html'>Position dialog</a><li><a href='Orientation dialog.html'>Orientation dialog</a><li><a href='Object movement via the mouse.html'>Object movement via the mouse</a><li><a href='On positions, orientations and transformations.html'>On positions, orientations and transformations</a><li><a href='User settings.html'>User settings</a><li><a href='Shortcuts.html'>Shortcuts</a></li></ul><li class='has-children'><a href='Scenes and models.html'>Scenes and models</a><ul class='dropdown'><li><a href='Scenes.html'>Scenes</a><li><a href='Models.html'>Models</a><li><a href='Model dialog.html'>Model dialog</a></li></ul><li class='has-children'><a href='Environment.html'>Environment</a><ul class='dropdown'><li><a href='Environment dialog.html'>Environment dialog</a><li><a href='Texture dialog.html'>Texture dialog</a></li></ul><li class='has-children'><a href='Entities.html'>Entities</a><ul class='dropdown'><li><a href='Collections.html'>Collections</a><li class='has-children'><a href='Scene objects.html'>Scene objects</a><ul class='dropdown'><li><a href='Object properties.html'>Object properties</a><li><a href='Object common properties.html'>Object common properties</a></li></ul><li><a href='Collidable objects.html'>Collidable objects</a><li><a href='Measurable objects.html'>Measurable objects</a><li><a href='Detectable objects.html'>Detectable objects</a><li><a href='Viewable objects.html'>Viewable objects</a><li><a href='Convex hull.html'>Convex hull</a><li class='has-children'><a href='Layer selection dialog.html'>Layer selection dialog</a><ul class='dropdown'><li><a href='Cameras.html'>Cameras</a><li><a href='Camera properties.html'>Camera properties</a><li><a href='Lights.html'>Lights</a><li><a href='Light properties.html'>Light properties</a><li><a href='Shapes.html'>Shapes</a><li><a href='Shape coordinate frame.html'>Shape coordinate frame</a><li><a href='Primitive shapes.html'>Primitive shapes</a><li><a href='Convex decomposition.html'>Convex decomposition</a><li><a href='Shape properties.html'>Shape properties</a><li><a href='Shape dynamics properties.html'>Shape dynamics properties</a><li><a href='Material properties.html'>Material properties</a><li><a href='Shape geometry dialog.html'>Shape geometry dialog</a><li><a href='Shape edit modes.html'>Shape edit modes</a><li><a href='Triangle edit mode.html'>Triangle edit mode</a><li><a href='Vertex edit mode.html'>Vertex edit mode</a><li><a href='Edge edit mode.html'>Edge edit mode</a><li><a href='Edit mode for compound shapes.html'>Edit mode for compound shapes</a><li><a href='Joints.html'>Joints</a><li><a href='Joint modes.html'>Joint modes</a><li><a href='Joint properties.html'>Joint properties</a><li><a href='Joint dynamics properties.html'>Joint dynamics properties</a><li><a href='Dynamics engines properties related to joints.html'>Dynamics engines properties related to joints</a><li><a href='Dummies.html'>Dummies</a><li><a href='Dummy properties.html'>Dummy properties</a><li><a href='Graphs.html'>Graphs</a><li><a href='Graph properties.html'>Graph properties</a><li><a href='Proximity sensors.html'>Proximity sensors</a><li><a href='Proximity sensor types and mode of operation.html'>Proximity sensor types and mode of operation</a><li><a href='Proximity sensor properties.html'>Proximity sensor properties</a><li><a href='Proximity sensor volume dialog.html'>Proximity sensor volume dialog</a><li><a href='Proximity sensor detection parameter dialog.html'>Proximity sensor detection parameter dialog</a><li><a href='Vision sensors.html'>Vision sensors</a><li><a href='Vision sensor types and mode of operation.html'>Vision sensor types and mode of operation</a><li><a href='Vision sensor properties.html'>Vision sensor properties</a><li><a href='Force sensors.html'>Force sensors</a><li><a href='Force sensor property.html'>Force sensor property</a><li><a href='OC trees.html'>OC trees</a><li><a href='OC tree properties.html'>OC tree properties</a><li><a href='Point clouds.html'>Point clouds</a><li><a href='Point cloud properties.html'>Point cloud properties</a></li></ul><li><a href='Paths.html'>Paths</a></li></ul><li class='has-children'><a href='Functionality.html'>Functionality</a><ul class='dropdown'><li><a href='Geometric calculations.html'>Geometric calculations</a><li><a href='Collision detection.html'>Collision detection</a><li class='has-children'><a href='Distance calculation.html'>Distance calculation</a><ul class='dropdown'><li><a href='Geometric plugin.html'>Geometric plugin</a><li><a href='simGeom API reference.html'>simGeom API reference</a><li><a href='Coppelia geometric routines.html'>Coppelia geometric routines</a><li><a href='API reference-1.html'>API reference-1</a></li></ul><li><a href='simIGL API reference.html'>simIGL API reference</a><li><a href='Kinematics.html'>Kinematics</a><li><a href='Basics on IK groups and IK elements.html'>Basics on IK groups and IK elements</a><li class='has-children'><a href='Solving IK and FK for any type of mechanism.html'>Solving IK and FK for any type of mechanism</a><ul class='dropdown'><li><a href='Kinematics plugin.html'>Kinematics plugin</a><li><a href='simIK API reference.html'>simIK API reference</a><li><a href='Coppelia kinematics routines.html'>Coppelia kinematics routines</a><li><a href='API reference-2.html'>API reference-2</a></li></ul><li><a href='Dynamics.html'>Dynamics</a><li class='has-children'><a href='Designing dynamic simulations.html'>Designing dynamic simulations</a><ul class='dropdown'><li><a href='General dynamics properties.html'>General dynamics properties</a><li><a href='Dynamics engines general properties.html'>Dynamics engines general properties</a></li></ul><li><a href='Data visualizationoutput.html'>Data visualizationoutput</a><li><a href='Web-browser based front-end.html'>Web-browser based front-end</a><li><a href='Data manipulationtransformation.html'>Data manipulationtransformation</a><li class='has-children'><a href='Messaginginterfacesconnectivity.html'>Messaginginterfacesconnectivity</a><ul class='dropdown'><li><a href='Remote API.html'>Remote API</a><li><a href='ZeroMQ remote API.html'>ZeroMQ remote API</a><li><a href='WebSocket remote API.html'>WebSocket remote API</a><li><a href='ROS Interfaces.html'>ROS Interfaces</a><li><a href='ROS Interface.html'>ROS Interface</a><li><a href='simROS API reference.html'>simROS API reference</a><li><a href='ROS 2 Interface.html'>ROS 2 Interface</a><li><a href='simROS2 API reference.html'>simROS2 API reference</a></li></ul><li><a href='simZMQ API reference.html'>simZMQ API reference</a><li><a href='simWS API reference.html'>simWS API reference</a><li><a href='Pathstrajectories.html'>Pathstrajectories</a><li><a href='Path planning.html'>Path planning</a><li><a href='simOMPL API reference.html'>simOMPL API reference</a><li><a href='Synthetic vision.html'>Synthetic vision</a><li><a href='simIM API reference.html'>simIM API reference</a><li><a href='simVision API reference.html'>simVision API reference</a><li><a href='Custom user interfaces.html'>Custom user interfaces</a><li><a href='simUI API reference.html'>simUI API reference</a><li><a href='simUI XML syntax.html'>simUI XML syntax</a><li><a href='simQML API reference.html'>simQML API reference</a><li><a href='Importexport.html'>Importexport</a><li class='has-children'><a href='XML format.html'>XML format</a><ul class='dropdown'><li><a href='URDF format.html'>URDF format</a><li><a href='simURDF API reference.html'>simURDF API reference</a><li><a href='SDF format.html'>SDF format</a><li><a href='simSDF API reference.html'>simSDF API reference</a></li></ul><li><a href='Video exporter.html'>Video exporter</a><li><a href='simAssimp API reference.html'>simAssimp API reference</a><li class='has-children'><a href='simGLTF API reference.html'>simGLTF API reference</a><ul class='dropdown'><li><a href='Commandssetting.html'>Commandssetting</a><li><a href='simLuaCmd API reference.html'>simLuaCmd API reference</a><li><a href='Miscellaneous.html'>Miscellaneous</a><li><a href='simSurfRec API reference.html'>simSurfRec API reference</a><li><a href='simICP API reference.html'>simICP API reference</a><li><a href='simSubprocess API reference.html'>simSubprocess API reference</a></li></li></ul></ul><li class='has-children'><a href='Coding.html'>Coding</a><ul class='dropdown'><li class='has-children'><a href='Scripts.html'>Scripts</a><ul class='dropdown'><li><a href='Embedded scripts.html'>Embedded scripts</a><li><a href='Simulation scripts.html'>Simulation scripts</a><li><a href='The main script.html'>The main script</a><li><a href='Child scripts.html'>Child scripts</a><li><a href='Customization scripts.html'>Customization scripts</a><li><a href='Script dialog.html'>Script dialog</a><li><a href='Script editor.html'>Script editor</a></li></ul><li><a href='Add-ons.html'>Add-ons</a><li><a href='The sandbox script.html'>The sandbox script</a><li><a href='Script execution order.html'>Script execution order</a><li class='has-children'><a href='Threaded and non-threaded script code.html'>Threaded and non-threaded script code</a><ul class='dropdown'><li><a href='Callback functions.html'>Callback functions</a><li><a href='Dynamics callback functions.html'>Dynamics callback functions</a><li><a href='Joint callback functions.html'>Joint callback functions</a><li><a href='Contact callback function.html'>Contact callback function</a><li><a href='Vision callback functions.html'>Vision callback functions</a><li><a href='Trigger callback functions.html'>Trigger callback functions</a><li><a href='User config callback functions.html'>User config callback functions</a></li></ul><li><a href='Lua vs Python scripts.html'>Lua vs Python scripts</a><li><a href='Lua crash course.html'>Lua crash course</a><li><a href='Plugins.html'>Plugins</a><li><a href='The main client application.html'>The main client application</a><li><a href='Accessing scene objects programmatically.html'>Accessing scene objects programmatically</a><li><a href='Explicit and non-explicit calls.html'>Explicit and non-explicit calls</a><li><a href='CoppeliaSim API framework.html'>CoppeliaSim API framework</a><li><a href='Regular API reference.html'>Regular API reference</a><li><a href='Regular API constants.html'>Regular API constants</a><li><a href='Object parameter IDs.html'>Object parameter IDs</a></li></ul><li class='has-children'><a href='Simulation.html'>Simulation</a><ul class='dropdown'><li><a href='Simulation settings dialog.html'>Simulation settings dialog</a></li></ul><li class='has-children'><a href='Tutorials.html'>Tutorials</a><ul class='dropdown'><li><a href='BubbleRob tutorial.html'>BubbleRob tutorial</a><li><a href='Building a clean model tutorial.html'>Building a clean model tutorial</a><li><a href='Line following BubbleRob tutorial.html'>Line following BubbleRob tutorial</a><li><a href='Inverse kinematics tutorial.html'>Inverse kinematics tutorial</a><li><a href='External controller tutorial.html'>External controller tutorial</a><li><a href='Plugin tutorial.html'>Plugin tutorial</a><li><a href='Robot language interpreter integration tutorial.html'>Robot language interpreter integration tutorial</a><li><a href='ROS tutorials.html'>ROS tutorials</a><li><a href='ROS tutorial.html'>ROS tutorial</a><li><a href='ROS 2 tutorial.html'>ROS 2 tutorial</a><li><a href='Compiling CoppeliaSim.html'>Compiling CoppeliaSim</a></li>
                      </ul>
                </nav>
              </div>
              <div class="d-inline-block d-xl-none ml-md-0 mr-auto py-3" style="position: relative; top: 3px;"><a href="#" class="site-menu-toggle js-menu-toggle text-black"><span class="icon-menu h3"></span></a></div>
              </div>

            </div>
          </div>
          
        </header>
    <div id="tipue_search_content">Tutorials << <a href='Tutorials.html'>Previous</a> <a href='Building a clean model tutorial.html'>Next</a> >> Building a clean model tutorial<br /><h1>BubbleRob tutorial</h1><div align="center">
<table class="allEncompassingTable">
<tr>
<td>
<p><a href="../index.html" target="_top"><img src="./../images/homeImg.png"/></a></p>
<h4>BubbleRob tutorial</h4>
<p>This tutorial will introduce quite many CoppeliaSim functionalities while designing the simple mobile robot <em>BubbleRob</em>. The CoppeliaSim scene file related to this tutorial is located in <em>scenes/tutorials/BubbleRob</em>. Following figure illustrates the simulation scene that we will design:<br/>
</p>
<p align="center"><img src="./../images/bubbleRobTut1.jpg"/></p>
<br/>
<p>Since this tutorial will fly over many different aspects, make sure to also have a look at the <a href="tutorials.htm">other tutorials</a>, mainly the <a href="buildingAModelTutorial.htm">tutorial about building a simulation model</a>. First of all, freshly start CoppeliaSim. The simulator displays a default <a href="scenes.htm">scene</a>. We will start with the body of <em>BubbleRob</em>.</p>
<p>We add a primitive sphere of diameter 0.2 to the scene with [Menu bar --&gt; Add --&gt; Primitive shape --&gt; Sphere]. We adjust the <strong>X-size</strong> item to 0.2, then click <strong>OK</strong>. The created sphere will appear in the <a href="layerSelectionDialog.htm">visibility layer</a> 1 by default, and be <a href="designingDynamicSimulations.htm#staticAndRespondable">dynamic and respondable</a> (since we kept the item <strong>Create dynamic and respondable shape</strong> enabled). This means that <em>BubbleRob's</em> body will be falling and able to react to collisions with other respondable shapes (i.e. simulated by the physics engine). We can see this is the <a href="shapeDynamicsProperties.htm">shape dynamics properties</a>: items <strong>Body is respondable</strong> and <strong>Body is dynamic</strong> are enabled. We start the simulation (via the toolbar button, or by pressing &lt;control-space&gt; in the scene window), and copy-and-paste the created sphere (with [Menu bar --&gt; Edit --&gt; Copy selected objects] then [Menu bar --&gt; Edit -&gt; Paste buffer], or with &lt;control-c&gt; then &lt;control-v&gt;): the two spheres will react to collision and roll away. We stop the simulation: the duplicated sphere will automatically be removed. This default behaviour can be modified in the <a href="simulationPropertiesDialog.htm">simulation dialog</a>.</p>
<p>We also want the <em>BubbleRob's</em> body to by usable by the other calculation modules (e.g. <a href="distanceCalculation.htm">distance calculation</a>). For that reason, we enable <a href="collidableObjects.htm">Collidable</a>, <a href="measurableObjects.htm">Measurable</a> and <a href="detectableObjects.htm">Detectable</a> in the <a href="commonPropertiesDialog.htm">object common properties</a> for that shape, if not already enabled. If we wanted, we could now also change the visual appearance of our sphere in the <a href="shapeProperties.htm">shape properties</a>.</p>
<p>Now we open the <a href="positionDialog.htm">position dialog</a> on the <strong>translation</strong> tab, select the sphere representing <em>BubbleRob's</em> body, and  enter 0.02 for <strong>Along Z</strong>. We make sure that the<strong> Relative to</strong>-item is set to <strong>World</strong>. Then we click <strong>Translate selection</strong>. This translates all selected objects by 2 cm along the absolute Z-axis, and effectively lifted our sphere a little bit. In the <a href="userInterface.htm#SceneHierarchy">scene hierarchy</a>, we double-click the sphere's alias, so that we can edit it. We enter <em>bubbleRob</em> and press enter.</p>
<p>Next we will add a <a href="proximitySensors.htm">proximity sensor</a> so that <em>BubbleRob</em> knows when it is approaching obstacles: we select [Menu bar --&gt; Add --&gt; Proximity sensor --&gt; Cone type]. In the <a href="orientationDialog.htm">orientation dialog</a> on the <strong>orientation</strong> tab, we enter 90 for <strong>Around Y</strong> and for <strong>Around Z</strong>, then click <strong>Rotate selection</strong>. In the <a href="positionDialog.htm">position dialog</a>, on the <strong>position</strong> tab, we enter 0.1 for <strong>X-coord.</strong> and 0.12 for <strong>Z-coord.</strong> The proximity sensor is now correctly positioned relative to <em>BubbleRob's</em> body. We double-click the proximity sensor's icon in the <a href="userInterface.htm#SceneHierarchy">scene hierarchy</a> to open <a href="proximitySensorPropertiesDialog.htm">its properties</a> dialog. We click <strong>Show volume parameter </strong> to open the <a href="proximitySensorVolumeDialog.htm">proximity sensor volume dialog</a>. We adjust items <strong>Offset</strong> to 0.005, <strong>Angle</strong> to 30 and <strong>Range</strong> to 0.15. Then, in the <a href="proximitySensorPropertiesDialog.htm">proximity sensor properties</a>, we click <strong>Show detection parameters</strong>. This opens the <a href="proximitySensorDetectionParameterDialog.htm">proximity sensor detection parameter dialog</a>. We uncheck item <strong>Don't allow detections if distance smaller than</strong> then close that dialog again. In the scene hierarchy, we double-click the proximity sensor's alias in order to edit it. We enter <em>sensingNose</em> and press enter.<br/>
</p>
<p>We select <em>sensingNose</em>, then control-select <em>bubbleRob</em>, then click [Menu bar --&gt; Edit --&gt; Make last selected object parent]. This attaches the sensor to the body of the robot. We could also have dragged <em>sensingNose</em> onto <em>bubbleRob</em> in the scene hierarchy. This is what we now have:<br/>
</p>
<p align="center"><img src="./../images/bubbleRobTut2.jpg"/></p>
<p class="imageLabel">[Proximity sensor attached to <em>bubbleRob's</em> body]</p>
<br/>
<p>Next we will take care of <em>BubbleRob's</em> wheels. We create a new scene with [Menu bar --&gt; File --&gt; New scene]. It is often very convenient to work across several scenes, in order to visualize and work only on specific elements. We add a pure primitive cylinder with dimensions (0.08,0.08,0.02). As for the body of <em>BubbleRob</em>, we enable  <a href="collidableObjects.htm">Collidable</a>, <a href="measurableObjects.htm">Measurable</a> and <a href="detectableObjects.htm">Detectable</a> in the <a href="commonPropertiesDialog.htm">object common properties</a> for that cylinder, if not already enabled. Then we set the cylinder's absolute position to (0.05,0.1,0.04) and its absolute orientation to (-90,0,0).  We change the alias to <em>leftWheel</em>. We copy and paste the wheel, and set the absolute Y coordinate of the copy to -0.1. We rename the copy to <em>rightWheel</em>. We select the two wheels, copy them, then switch back to scene 1, then paste the wheels.</p>
<p>We now need to add <a href="joints.htm">joints</a> (or motors) for the wheels. We click [Menu bar --&gt; Add --&gt; Joint --&gt; Revolute] to add a revolute joint to the scene. Most of the time, when adding a new object to the scene, the object will appear at the origin of the world. We Keep the joint selected, then control-select <em>leftWheel</em>. In the <a href="positionDialog.htm">position dialog</a>, on the <strong>position</strong> tab, we click the <strong>Apply to selection</strong> button: this positioned the joint at the center of the left wheel. Then, in the <a href="orientationDialog.htm">orientation dialog</a>, on the <strong>orientation</strong> tab, we do the same: this oriented the joint in the same way as the left wheel. We rename the joint to <em>leftMotor</em>. We now double-click the joint's icon in the scene hierarchy to open the <a href="jointProperties.htm">joint properties</a> dialog. Then we click <strong>Show dynamic parameters</strong> to open the <a href="jointDynamicsProperties.htm">joint dynamics properties</a> dialog. We <strong>enable the motor</strong>, and check item <strong>Lock motor when target velocity is zero</strong>. We now repeat the same procedure for the right motor and rename it to <em>rightMotor</em>. Now we attach the left wheel to the left motor, the right wheel to the right motor, then attach the two motors to <em>bubbleRob</em>. This is what we have:</p>
<p align="center"><img src="./../images/bubbleRobTut3.jpg"/></p>
<p class="imageLabel">[Proximity sensor, motors and wheels]</p>
<br/>
<p>We run the simulation and notice that the robot is falling backwards. We are still missing a third contact point to the floor. We now add a small slider (or caster). In a new scene we and add a pure primitive sphere with diameter 0.05 and make the sphere <a href="collidableObjects.htm">Collidable</a>, <a href="measurableObjects.htm">Measurable</a> and <a href="detectableObjects.htm">Detectable</a> (if not already enabled), then rename it to <em>slider</em>. We set the <strong>Material</strong> to <em>noFrictionMaterial </em>in the <a href="shapeDynamicsProperties.htm">shape dynamics properties</a>. To rigidly link the slider with the rest of the robot, we add a<a href="forceSensors.htm"> force sensor object</a> with [Menu bar --&gt; Add --&gt; Force sensor]. We rename it to <em>connection</em> and shift it up by 0.05. We attach the slider to the force sensor, then copy both objects, switch back to scene 1 and paste them. We then shift the force sensor by -0.07 along the absolute X-axis, then attach it to the robot body. If we run the simulation now, we can notice that the slider is slightly moving in relation to the robot body: this is because both objects (i.e. <em>slider</em> and <em>bubbleRob</em>) are colliding with each other. To avoid strange effects during dynamics simulation, we have to inform CoppeliaSim that both objects do not mutually collide, and we do this in following way: in the <a href="shapeDynamicsProperties.htm">shape dynamics properties</a>, for <em>slider</em> we set the <strong>local respondable mask</strong> to 00001111, and for <em>bubbleRob</em>, we set the<strong> local respondable mask</strong> to 11110000. If we run the simulation again, we can notice that both objects do not interfere anymore. This is what we now have:</p>
<p align="center"><img src="./../images/bubbleRobTut4.jpg"/></p>
<p class="imageLabel">[Proximity sensor, motors, wheels and slider]</p>
<br/>
<p>We run the simulation again and notice that <em>BubbleRob</em> slightly moves, even with locked motor. We also try to run the simulation with different physics engines: the result will be different. Stability of dynamic simulations is tightly linked to masses and inertias of the involved non-static shapes. For an explanation of this effect, make sure to carefully read <a href="designingDynamicSimulations.htm#masses">this</a> and <a href="designingDynamicSimulations.htm#inertias">that</a> sections. We now try to correct for that undesired effect. We select the two wheels and the slider, and in the shape dynamics dialog we click three times <strong>M=M*2 (for selection)</strong>. The effect is that all selected shapes will have their masses multiplied by 8. We do the same with the inertias of the 3 selected shapes, then run the simulation again: stability has improved. In the joint dynamics dialog, we set the <strong>Target velocity</strong> to 50 for both motors. We run the simulation: <em>BubbleRob</em> now moves forward and eventually falls off the floor. We reset the <strong>Target velocity</strong> item to zero for both motors.<br/>
</p>
<p>The object <em>bubbleRob</em> is at the base of all <a href="objects.htm">objects</a> that will later form the <em>BubbleRob</em> <a href="models.htm">model</a>. We will define the model a little bit later. Next we are going to add a <a href="graphs.htm">graph object</a> to <em>BubbleRob</em> in order to display its clearance distance. We click [Menu bar --&gt; Add --&gt; Graph] and rename it to <em>graph</em>. We attach the graph to <em>bubbleRob</em>, and set the graph's absolute coordinates to (0,0,0.005).</p>
<p>Now we set one motor <strong>target velocity</strong> to 50, run the simulation, and will see <em>BubbleRob's</em> trajectory displayed in the scene. We then stop the simulation and reset the motor target velocity to zero.<br/>
</p>
<p>We add a pure primitive cylinder with following dimensions: (0.1, 0.1, 0.2). We want this cylinder to be static (i.e. not influenced by gravity or collisions) but still exerting some collision responses on non-static respondable shapes. For this, we disable <strong>Body is dynamic</strong> in the <a href="shapeDynamicsProperties.htm">shape dynamics properties</a>. We also want our cylinder to be <a href="collidableObjects.htm">Collidable</a>, <a href="measurableObjects.htm">Measurable</a> and <a href="detectableObjects.htm">Detectable</a>. We do this in the <a href="commonPropertiesDialog.htm">object common properties</a>. Now, while the cylinder is still selected, we click the object translation toolbar button:<br/>
</p>
<p align="center"><img src="./../images/objectShiftButton.jpg"/></p>
<br/>
<p>Now we can drag any point in the scene: the cylinder will follow the movement while always being constrained to keep the same Z-coordinate. We copy and paste the cylinder a few times, and move them to positions around <em>BubbleRob</em> (it is most convenient to perform that while looking at the scene from the top). During object shifting, holding down the shift key allows to perform smaller shift steps. Holding down the ctrl key allows to move in an orthogonal direction to the <em>regular</em> direction(s). When done, select the camera pan toolbar button again:<br/>
</p>
<p align="center"><img src="./../images/cameraShiftButton.jpg"/></p>
<br/>
<p>We set a <strong>target velocity</strong> of 50 for the left motor and run the simulation: the graph view now displays the distance to the closest obstacle and the distance segment is visible in the scene too. We stop the simulation and reset the target velocity to zero.<br/>
</p>
<p>We now need to finish <strong>BubbleRob</strong> as a <a href="models.htm">model</a> definition. We select the model base (i.e. object <em>bubbleRob</em>) then check <strong>Object is model base</strong> in the <a href="commonPropertiesDialog.htm">object common properties</a>: there is now a stippled bounding box that encompasses all objects in the model hierarchy. We select the two joints, the proximity sensor and the graph, then enable item <strong>Ignored by model bounding box</strong> and click <strong>Apply to selection</strong>, in the same dialog: the model bounding box now ignores the two joints and the proximity sensor. Still in the same dialog, we disable <strong>camera visibility layer</strong> 2, and enable <strong>camera visibility layer</strong> 10 for the two joints and the force sensor: this effectively hides the two joints and the force sensor, since layers 9-16 are disabled by default. At any time we can <a href="layerSelectionDialog.htm">modify the visibility layers for the whole scene</a>. To finish the model definition, we select the vision sensor, the two wheels, the slider, and the graph, then enable item <strong>Select base of model instead</strong>: if we now try to select an object in our model in the scene, the whole model will be selected instead, which is a convenient way to handle and manipulate the whole model as a single object. Additionally, this protects the model against inadvertant modification. Individual objects in the model can still be selected in the scene by click-selecting them with control-shift, or normally selecting them in the scene hierarchy. We finally collapse the model tree in the scene hierarchy.</p>
<p>Next we will add a <a href="visionSensors.htm">vision sensor</a>, at the same position and orientation as <em>BubbleRob's</em> proximity sensor. We open the model hierarchy again, then click [Menu bar --&gt; Add --&gt; Vision sensor --&gt; Perspective type], then attach the vision sensor to the proximity sensor, and set the local position and orientation of the vision sensor to (0,0,0). We also make sure the vision sensor is not not visible, not part of the model bounding box, and that if clicked, the model will be selected instead. In order to customize the vision sensor, we open <a href="visionSensorPropertiesDialog.htm">its properties</a> dialog. We set the <strong>Far clipping plane</strong> item to 1, and the <strong>Resolution x</strong> and <strong>Resolution y</strong> items to 256 and 256.  We add a floating view to the scene, and over the newly added floating view, right-click [Popup menu --&gt; View --&gt; Associate view with selected vision sensor] (we make sure the vision sensor is selected during that process). 


<p>We attach a child script to the vision sensor by clicking [Menu bar --&gt; Add --&gt; Associated child script --&gt; Non threaded]. We double-click the icon that appeared next to the vision sensor in the scene hierarchy: this opens the child script that we just added. We copy and paste following code into the <a href="scriptEditor.htm">script editor</a>, then close it:<br/>
</p>
<code class="hljs language-lua coppelia-coppeliasim-script">
function sysCall_vision(inData)
    simVision.sensorImgToWorkImg(inData.handle) -- copy the vision sensor image to the work image
    simVision.edgeDetectionOnWorkImg(inData.handle,0.2) -- perform edge detection on the work image
    simVision.workImgToSensorImg(inData.handle) -- copy the work image to the vision sensor image buffer
end

function sysCall_init()
end
</code>
<p>
To be able to see the vision sensor's image, we start the simulation, then stop it again.<br/>
</p>
<p>The last thing that we need for our scene is a small <a href="childScripts.htm">child script</a> that will control <em>BubbleRob's</em> behavior. We select <em>bubbleRob</em> and click [Menu bar --&gt; Add --&gt; Associated child script --&gt; Non threaded]. We double-click the script icon that appeared next to <em>bubbleRob's</em> alias in the scene hierarchy and copy and paste following code into the <a href="scriptEditor.htm">script editor</a>, then close it:<br/>
</p>
<code class="hljs language-lua coppelia-coppeliasim-script">
function speedChange_callback(ui,id,newVal)
    speed=minMaxSpeed[1]+(minMaxSpeed[2]-minMaxSpeed[1])*newVal/100
end

function sysCall_init()
    -- This is executed exactly once, the first time this script is executed
    bubbleRobBase=sim.getObject('.') -- this is bubbleRob's handle
    leftMotor=sim.getObject("./leftMotor") -- Handle of the left motor
    rightMotor=sim.getObject("./rightMotor") -- Handle of the right motor
    noseSensor=sim.getObject("./sensingNose") -- Handle of the proximity sensor
    minMaxSpeed={50*math.pi/180,300*math.pi/180} -- Min and max speeds for each motor
    backUntilTime=-1 -- Tells whether bubbleRob is in forward or backward mode
    robotCollection=sim.createCollection(0)
    sim.addItemToCollection(robotCollection,sim.handle_tree,bubbleRobBase,0)
    distanceSegment=sim.addDrawingObject(sim.drawing_lines,4,0,-1,1,{0,1,0})
    robotTrace=sim.addDrawingObject(sim.drawing_linestrip+sim.drawing_cyclic,2,0,-1,200,{1,1,0})
    graph=sim.getObject('./graph')
    distStream=sim.addGraphStream(graph,'bubbleRob clearance','m',0,{1,0,0})
    -- Create the custom UI:
        xml = '&lt;ui title="'..sim.getObjectAlias(bubbleRobBase,1)..' speed" closeable="false" resizeable="false" activate="false"&gt;'..[[
        &lt;hslider minimum="0" maximum="100" onchange="speedChange_callback" id="1"/&gt;
        &lt;label text="" style="* {margin-left: 300px;}"/&gt;
        &lt;/ui&gt;
        ]]
    ui=simUI.create(xml)
    speed=(minMaxSpeed[1]+minMaxSpeed[2])*0.5
    simUI.setSliderValue(ui,1,100*(speed-minMaxSpeed[1])/(minMaxSpeed[2]-minMaxSpeed[1]))
end

function sysCall_sensing()
    local result,distData=sim.checkDistance(robotCollection,sim.handle_all)
    if result&gt;0 then
        sim.addDrawingObjectItem(distanceSegment,nil)
        sim.addDrawingObjectItem(distanceSegment,distData)
        sim.setGraphStreamValue(graph,distStream,distData[7])
    end
    local p=sim.getObjectPosition(bubbleRobBase,-1)
    sim.addDrawingObjectItem(robotTrace,p)
end

function sysCall_actuation()
    result=sim.readProximitySensor(noseSensor) -- Read the proximity sensor
    -- If we detected something, we set the backward mode:
    if (result&gt;0) then backUntilTime=sim.getSimulationTime()+4 end 

    if (backUntilTime&lt;sim.getSimulationTime()) then
        -- When in forward mode, we simply move forward at the desired speed
        sim.setJointTargetVelocity(leftMotor,speed)
        sim.setJointTargetVelocity(rightMotor,speed)
    else
        -- When in backward mode, we simply backup in a curve at reduced speed
        sim.setJointTargetVelocity(leftMotor,-speed/2)
        sim.setJointTargetVelocity(rightMotor,-speed/8)
    end
end

function sysCall_cleanup()
    simUI.destroy(ui)
end</code>
<p>We run the simulation. <em>BubbleRob</em> now moves forward while trying to avoid obstacles (in a very basic fashion). While the simulation is still running, change <em>BubbleRob's</em> velocity, and copy/paste it a few times. Also try to scale a few of them while the simulation is still running. Be aware that the minimum distance calculation functionality might be heavily slowing down the simulation, depending on the environment.</p>
<p>Using a script to control a robot or model is only one way of doing. CoppeliaSim offers many different ways (also combined), have a look at the <a href="externalControllerTutorial.htm">external controller tutorial</a>.</p>
<br/>
<br/>
</p></td></tr>
</table>
</div><br />Tutorials << <a href='Tutorials.html'>Previous</a> <a href='Building a clean model tutorial.html'>Next</a> >> Building a clean model tutorial</div>
        
    <!-- footer -->
      <div class="container">
        <div class="row pt-3 mx-auto">
            <p>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank" >Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
        </div>
      </div>
    <!-- for footer -->
    
        </div> <!-- for site wrap -->
            <!-- <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script> -->
            <script src="../cmsimde/static/chimper/js/jquery-migrate-3.0.1.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery-ui.js"></script>
            <script src="../cmsimde/static/chimper/js/popper.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap.min.js"></script>
            <script src="../cmsimde/static/chimper/js/owl.carousel.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.stellar.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.countdown.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.magnific-popup.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap-datepicker.min.js"></script>
            <script src="../cmsimde/static/chimper/js/aos.js"></script>
            <!--
            <script src="../cmsimde/static/chimper/js/typed.js"></script>
                    <script>
                    var typed = new Typed('.typed-words', {
                    strings: ["Web Apps"," WordPress"," Mobile Apps"],
                    typeSpeed: 80,
                    backSpeed: 80,
                    backDelay: 4000,
                    startDelay: 1000,
                    loop: true,
                    showCursor: true
                    });
                    </script>
            -->
            <script src="../cmsimde/static/chimper/js/main.js"></script>
        
<!-- 啟用 LaTeX equations 編輯 -->
  <!-- <script>
  MathJax = {
    tex: {inlineMath: [['$', '$'], ['\(', '\)']]}
  };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>-->
    </body></html>
        